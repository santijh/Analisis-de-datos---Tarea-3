#lib import
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier, plot_tree
from sklearn.metrics import accuracy_score
#load dataset
data = pd.read_csv("winequality-red.csv")
data.head()
data.describe()
data.isna().sum()
plt.hist(data.quality)
sns.scatterplot(x = "alcohol", y = "pH", hue = "quality", data = data)
predictors_col = ["density", "pH", "alcohol", "residual sugar"]
target_col = ["quality"]
predictors = data[predictors_col]
target = data[target_col]
predictors
target
corr = predictors.corr()
corr
sns.heatmap(corr)
plt.show()
X_train, X_test, y_train, y_test = train_test_split(predictors, target, test_size=0.3, random_state=13)
tree = DecisionTreeClassifier()
arbol = tree.fit(X_train, y_train)
plot_tree(arbol)
predicciones = arbol.predict(X_test)
predicciones
#check confusion matriz
pd.crosstab(np.array([y[0] for y in y_test.values.tolist()]), predicciones, rownames=['Actual'], colnames=['Predicciones'])
accuracy = accuracy_score(y_test,predicciones)
accuracy
0.621875
